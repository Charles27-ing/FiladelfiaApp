---
// src/components/Preloader.astro
---
<div id="preloader" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center" style="display: none;">
    <div class="flex flex-col items-center bg-white p-8 rounded-lg shadow-xl">
      <!-- Estado de carga: Spinner azul -->
      <div id="preloader-spinner" class="w-16 h-16 border-4 border-t-4 border-gray-200 border-t-blue-600 rounded-full animate-spin"></div>

      <!-- Estado de éxito: Checkmark verde -->
      <div id="preloader-success" class="hidden w-16 h-16 flex items-center justify-center">
        <svg class="w-12 h-12 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>

      <p id="preloader-text" class="mt-4 text-lg font-medium text-gray-700">guardando</p>
    </div>
  </div>

  <script>
    // Función para mostrar el preloader en estado de carga
    (window as any).showPreloader = function() {
      const preloader = document.getElementById('preloader');
      const spinner = document.getElementById('preloader-spinner');
      const success = document.getElementById('preloader-success');
      const text = document.getElementById('preloader-text');

      if (preloader && spinner && success && text) {
        spinner.classList.remove('hidden');
        success.classList.add('hidden');
        text.textContent = 'guardando';
        preloader.style.display = 'flex';
      }
    };

    // Función para mostrar el preloader en estado de éxito
    (window as any).showPreloaderSuccess = function(message = '¡Actividad registrada con éxito!') {
      const preloader = document.getElementById('preloader');
      const spinner = document.getElementById('preloader-spinner');
      const success = document.getElementById('preloader-success');
      const text = document.getElementById('preloader-text');

      if (preloader && spinner && success && text) {
        spinner.classList.add('hidden');
        success.classList.remove('hidden');
        text.textContent = message;

        // Mostrar por 1 segundo y luego ocultar
        setTimeout(() => {
          preloader.style.display = 'none';
        }, 1000);
      }
    };

    // Función para ocultar el preloader
    (window as any).hidePreloader = function() {
      const preloader = document.getElementById('preloader');
      if (preloader) {
        preloader.style.display = 'none';
      }
    };
  </script>